\documentclass[11pt,a4paper]{report}
\usepackage[utf8]{inputenc}
\usepackage[francais]{babel}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{graphicx}
\usepackage{fullpage}
\usepackage{titlesec}
\usepackage{amsthm}
\usepackage{minted}
\usepackage[top=1cm]{geometry}

% Plain text
\newminted{matlab}{frame=single, framesep=6pt, breaklines=true, breakanywhere, fontsize=\scriptsize}
\newmintedfile{matlab}{frame=single, framesep=6pt, breaklines=true, fontsize=\scriptsize}

\titleformat{\chapter}{}{\bf\LARGE\thechapter. \space}{0em}{\bf\LARGE}
\setlength{\parindent}{0pt}

\newcommand{\matd}[4]{\begin{pmatrix}#1 & #2 \\ #3 & #4\end{pmatrix}}
\newcommand{\matdd}[2]{\begin{pmatrix}#1 \\ #2\end{pmatrix}}
\newcommand{\matddd}[3]{\begin{pmatrix}#1\\#2\\#3\end{pmatrix}}
\newcommand{\matdddd}[4]{\begin{pmatrix}#1\\#2\\#3\\#4\end{pmatrix}}

\newcommand{\matnnn}[3]{\begin{matrix}#1 \\ #2 \\ #3\end{matrix}}
\newcommand{\matv}[2]{\begin{bmatrix}#1 \\ #2 \end{bmatrix}}
\newcommand{\mato}[1]{\begin{bmatrix}#1\end{bmatrix}}
\newcommand{\binomial}[2]{\begin{pmatrix}#1 \\ #2\end{pmatrix}}
\newcommand{\vecnorm}[1]{||#1||}
\newcommand{\R}{\mathbb{R}}

\newcommand{\partderiv}[2]{\frac{\partial #1}{\partial #2}}

\newcommand{\normun}[1]{||#1||_1}
\newcommand{\normdeux}[1]{||#1||_2}
\newcommand{\norminf}[1]{||#1||_{\infty}}

\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{#1}}
\makeatother

\author{Sylvain Julmy}
\title{Calcul formet et numérique en ingénierie : Résumé du cours}

\begin{document}

\maketitle

\tableofcontents

\chapter{Banach TODO}

Banach est un résultant théorique, en pratique c'est compliqué de trouvé un bon D.

Matrice de Jacobi : On dérive F et G par rapport à x et y, on obtient donc une matrice 2x2

Norme matriciel : racine de la somme des éléments au carré
$$\sqrt{\sum{M_{i,j}}}$$

F est une contraction de D si
$$
max_{(x,y\in D)} ||J(x,y)|| < 1
$$

On cherche donc le maximum de l'expression $||\textbf{J}(x,y)||$
\section{Exemple}
On à $$||\textbf{J}(x,y)|| = \frac{1}{10}(\begin{array}{cc}
2x & 2y \\ 
y^2+1 & 2xy
\end{array})$$

on obtient donc la norme matricielle
$$
||\textbf{J}(x,y)|| = \frac{1}{10}\sqrt{4x^2+4y^2+(y^2+1)+4x^2y^2}
$$

Le vecteur d'erreur est donné par
$$
e_k = x_k - r = (\begin{array}{c}
x_k-r \\ 
y_k-s
\end{array} ) = (\begin{matrix}
\varepsilon_k \\ 
\delta_k
\end{matrix})
$$

Si $\textbf{J}(r,s)$ est nulle : convergence quadratique, sinon linéaire.

\chapter{Courbes de Bézier}

\section{Algorithme de Casteljo}

On donne trois point $b_0$,$b_1$ et $b_2$ et on calcule les interpolations linéaires :
\begin{align*}
& b_0^1 = (1-t)\cdot b_0 + t \cdot b_1    \\
& b_1^1 = (1-t)\cdot b_1 + t \cdot b_2    \\
& b_0^2 = (1-t)\cdot b_0^1 + t \cdot b_1^1\\
\end{align*}

Et on simplifie $b_0^2$ avec $b_0^1$ et $b_1^1$ :
$$
b_0^2 = (1-t^2)b_0 + 2t(1-t)b_1 + t^2b_2
$$

On peut représenter cela sous une forme d'une matrice de vecteur triangulaire : tout ce qui se trouve au dessus de la diagonale est ignoré :
\begin{align*}
& \mato{b_0^0} \\
& \mato{b_1^0} \mato{b_0^1}\\
& \mato{b_2^0} \mato{b_1^1} \mato{b_0^2}\\
\end{align*}

Où les éléments de la première colonne sont donnés et que le calcul de $b_{n}^{m}$ est donné par 
$$
b_{n}^{m} = (1-t) \cdot b_{n}^{m-1} + t \cdot b_{n+1}^{m-1}
$$

avec $t$ donné.

\subsection*{Exemple}
$b_0 = \matv{0}{0}$,$b_1 = \matv{0}{2}$,$b_2 = \matv{8}{2}$,$b_3 = \matv{4}{0}$ : calculé $b^3_0$ avec $t=0.5$.
\subsection*{Solution}
\begin{align*}
& \matv{0}{0} \\
& \matv{0}{2} \matv{0}{1} \\
& \matv{8}{2} \matv{4}{2} \matv{2.0}{1.5} \\
& \matv{4}{0} \matv{6}{1} \matv{5.0}{1.5} \matv{3.5}{1.5} \\
\end{align*}

\section{Les polynômes de Bernstein}

Les polynômes de Bernstein sont donnés par la formule suivante :
$$
B_i^n(t) = \binomial{n}{i}t^i(1-t)^{n-i} \ \text{, pour $i = 0,1,..,n$} 
$$
\begin{center}
\begin{tabular}{|c|l|l|l|l|}
\hline 
$n$ & $i = 0$ & $i = 1$ & $i = 2$ & $i = 3$ \\  \hline
\hline 
$0$ & $B^0_0 = 1$ & & & \\ 
$1$ & $B^1_0 = 1-t$ & $B^1_0 = t$ & & \\ 
$2$ & $B^2_0 = (1-t)^2$ & $B^2_0 = 2t(1-t)$ & $B^2_0 = t^2$ & \\ 
$3$ & $B^3_0 = (1-t)^3$ & $B^3_1 = 3t(1-t)^2$ & $B^3_1 = 3t^2(1-t)$ & $B^3_3 = t^3$ \\ 
\hline 
\end{tabular}
\end{center}

\section{Courbe de Bézier et polynômes de Bernstein}

En prenant 3 points : $b_0 = \matv{0}{0},b_1 = \matv{1}{2},b_2 = \matv{2}{0.5}$, on veut donner la paramétrisation de la courbe de Bézier associée à ces points de contrôles en utilisant les polynômes de Bernstein:

\begin{align*}
\vec{x}(t) &= \vec{b}_0^2(t) \\ 
           &= B_0^2(t) \vec{b_0} + B_1^2(t) \vec{b_1} + B_2^2(t) \vec{b_2} \\
           &= (1-t)^2 \matv{0}{0} + 2 \cdot t \cdot (1-t) \matv{1}{2} + t^2 \matv{2}{0.5}
\end{align*}

ou bien avec 4 points :
$$
x(t) = b_0B_0^3(t)+b_1B_1^3(t)+b_2B_2^3(t)+b_3B_3^3(t)
$$

\subsection*{Exemple}
Donner la paramétrisation de la courbe de Bézier associée aux points de contrôle :
$$
b_0 = \matv{0}{0} \ \text{,} \ b_0 = \matv{1}{2} \ \text{,} \ b_0 = \matv{2}{0.5}
$$
\subsection*{Solution}
\begin{align*}
x(t) &= b_0^2(t) = \sum_{j=0}^{n}b_{i+j}B_j^r(t) \\
     &= b_0B_0^2(t) + b_1B_1^2(t) + b_2B_2^2(t) \\
     &= \matv{0}{0} \cdot (1-t)^2 + \matv{1}{2} \cdot 2t(1-t) + \matv{2}{0.5} \cdot t^2
\end{align*}

\section{Exercice 1}
\subsection{a}
\begin{align*}
&\matv{0.0}{0.0} \\
&\matv{1.0}{2.0} \matv{0.5}{1.0}\\
&\matv{3.0}{2.0} \matv{2.0}{2.0} \matv{1.25}{1.50}\\
&\matv{3.0}{0.0} \matv{3.0}{1.0} \matv{2.50}{1.50} \matv{1.875}{1.5}\\
\end{align*}
\subsection{b}
voir corrigé du cours
\subsection{c}
\begin{align*}
\vec{x}(t) &= \vec{b}_0^3(t) = B_0^3(b)\vec{b}_0 + B_1^3(b)\vec{b}_1 + B_2^3(b)\vec{b}_2 \\
           &= (1-t)^2 \matv{0}{0} + 3t(1-t) \matv{1}{2} + 3t^2(1-t)\matv{3}{2} + t^3\matv{3}{0}
\end{align*}
\section{Exercice 2}
\subsection*{(a)}
\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline 
i & 0 & 1 & 2 & 3 \\ \hline\hline 
$x_i$ & 0.0 & 1.5 & 3.0 & 3.0 \\ \hline 
$y_i$ & 1.0 & 1.0 & 0.6 & 0.0 \\ \hline 
\end{tabular}
\end{center}

On souhaite que les deux points suivent la direction de la tangente, 
\subsection*{(b)}
\begin{align*}
& \matv{0.0}{1.0} \\
& \matv{1.5}{1.0} \matv{1.125}{1.000} \\
& \matv{3.0}{0.6} \matv{2.625}{0.700} \matv{2.25000}{0.77500} \\
& \matv{3.0}{0.0} \matv{3.000}{0.150} \matv{2.90625}{2.90625} \matv{2.742}{0.409} \\
\end{align*}

\subsection*{(c)}
\begin{align*}
x(t) &= b_0B^3_0(t) + b_1B^3_1(t) + b_2B^3_2(t) + b_3B^3_3(t) \\
     &= \matv{0.0}{1.0} \cdot (1-t)^3 + \matv{1.5}{1.0} \cdot 3t(1-t)^2 + \matv{3.0}{0.6} \cdot 3t^2(1-t) + \matv{3.0}{0.0} \cdot t^3
\end{align*}

\section{Exercice 3}
\section{Exercice 4}
\section{Exercice 5}


\chapter{Systèmes linéaires}
On cherche à résoudre $Ax=b$ avec $A$ une matrice $(m,n)$, $b\in \mathbb{R}^m$ et $x\in \mathbb{R}^n$, on suppose que $x$ existe et on utilise des matrices de taille $(n,n)$.

Opérations autorisées :
\begin{itemize}
    \item Multiplier une équation par une constante
    \item Ajouter une équation à une autre
\end{itemize}

\subsection*{Exemple}
$$
\begin{array}{cccc}
10x_1 & -7x_2 & 0 & =7 \\ 
-3x_1 & 2x_2 & 6x_3 & =4 \\ 
5x_1 & -x_2 & 5x_3 & =6
\end{array} 
$$
On peut l'écrire 
$$
\begin{pmatrix}
 10 & -7 & 0       \\
 -3 & 2 &   6     \\
 5 &  -1 &   5     
\end{pmatrix}
\begin{pmatrix}
 x_1    \\
 x_2    \\
 x_3     
\end{pmatrix}
=
\begin{pmatrix}
 7  \\
 4    \\
 6     
\end{pmatrix}
\Longleftrightarrow
\begin{pmatrix}[ccc|c]
 10 & -7 & 0   & 7    \\
 -3 & 2 &   6  & 4  \\
 5 &  -1 &   5 & 6  
\end{pmatrix}
$$
On va travailler uniquement avec la matrice $A$

\section{Décomposition de la matrice}

$a_{11}$ est le pivot du premier pas, on calcule les multiplicateurs $l_{21}$ et $l_{31}$ en effectuant :
\begin{align*}
& l_{21} = \frac{a_{21}}{a_{11}} \\
& l_{31} = \frac{a_{31}}{a_{11}}
\end{align*}
On change ensuite chaque ligne de $A$ avec les deux multiplicateurs :
$$
\begin{pmatrix}
L_1  = L_1\\
L_2  = L_2 - l_{21}\cdot L_1\\
L_3  = L_3 - l_{31}\cdot L_1
\end{pmatrix}
$$

et pour le deuxième pas, le pivot est $a_{22}$ on calcule donc $l_{32} = \frac{a_{32}}{a_{22}}$ et on effectue la nouvelle matrice avec le multiplicateur :

$$
\begin{pmatrix}
L_1  = L_1\\
L_2  = L_2 - l_{21}\cdot L_1\\
L_3 = L_3 - l_{31}\cdot L_1 = (L_3 - l_{31}\cdot L_1) - l_{32}L_2
\end{pmatrix}
$$

On peut exprimer $A$ sous la forme $A=LU$, en reprenant $A$ de l'exemple précédent :
$$
L = 
\begin{pmatrix}
1 & 0 & 0 \\
-0.3 & 1 & 0 \\
0.5 & -25 & 1
\end{pmatrix}
\text{ , }
U = 
\begin{pmatrix}
10 & -7 & 0 \\
0 & -0.1 & 6 \\
0 & 0 & 155
\end{pmatrix}
$$
$L$ est la matrice des multiplicateurs et $U$ la matrice des coefficients finaux.

\section{Résolution de $Ax=b$}

\begin{itemize}
    \item $Ax = b \longleftrightarrow LUx=b$
    \item $y = Ux$
    \item Résoudre $Ly = b$ : on trouve $y$ par substitution avant
    \item Résoudre $Ux = y$ : on trouve $x$ par substitution arrière
\end{itemize}

\subsection{Exercice}
Résoudre le système
$$
\begin{array}{cccc}
10x_1 & -7x_2 & 0 & =7 \\ 
-3x_1 & 2.099x_2 & 6x_3 & =3.901 \\ 
5x_1 & -x_2 & 5x_3 & =6
\end{array} 
$$

On pose
$$
A = 
\begin{pmatrix}
10 & -7 & 0 \\
-3 & 2.099 & 6 \\
5 & -1 & 5
\end{pmatrix}
$$

on calcule
\begin{align*}
& l_{21} = \frac{a_{21}}{a_{11}} = \frac{-3}{10} = -0.3 \\
& l_{31} = \frac{a_{31}}{a_{11}} = \frac{5}{10} = 0.5
\end{align*}
ce qui nous donne
$$
A' =
\begin{pmatrix}
10 & -7 & 0 \\
0 &  -0.0010 &   6.0000 \\
0 &   2.5000 &   5.0000
\end{pmatrix}
$$

on calcule
$$
l_{32} = \frac{a_{32}}{a_{22}} = \frac{2.5}{-0.0010} = -2500
$$

ce qui donne
$$
U =
\begin{pmatrix}
10 & -7 & 0 \\
0 &  -0.0010 &   6.0000 \\
0 & 0 & 1.5005
\end{pmatrix}
$$
$$
L = 
\begin{pmatrix}
  1  &       0   &      0 \\
  -0.3  &  1  &       0 \\
  0.5  & -2500  &  1
\end{pmatrix}
$$
$$
b =
\begin{pmatrix}
7 \\ 3.901 \\ 6
\end{pmatrix}
$$

et on résout $Ly=b$ et $Ux=y$ :
\begin{align*}
& y_1 = b_1  = 7\\
& y_2 = b_2 - -0.3 \cdot y_1 = 6.001\\
& y_3 = b_3 - 0.5 \cdot y_1 - -2500 \cdot y_2 = 15005  \\
& \rightarrow \\
& y_1 = b_1 \\
& y_2 = b_2 - L_{12} \cdot b_1 \\
& y_3 = b_3 - L_{13} \cdot b_1 - L_{23} \cdot b_2
\end{align*}

\chapter{Résidus et erreurs}
On veut résoudre le système $Ax=b$ en utilisant la factorisation $PA = LU$ sur :
$$
A = \matd{1}{2}{-3}{\pi} \qquad b = \matdd{1}{\frac{2}{3}}
$$

Il y aura des erreurs :
\begin{itemize}
   \item représentation machine de $A$
   \item représentation machine de $b$
   \item résolution de $PA = LU$
\end{itemize}

\section{Norme vectorielle}

La fonction $||\cdot|| : \mathbb{R}^n \rightarrow \mathbb{R}$ est appelée norme vectorielle si $\forall x,y \in \mathbb{R} \wedge \alpha \in \mathbb{R}$ les propriétés suivantes sont respectés :
\begin{itemize}
    \item $\vecnorm{x} \geq 0$
    \item $\vecnorm{x} = 0 \Longleftrightarrow x = 0$
    \item $\vecnorm{\alpha x} = |\alpha|\cdot\vecnorm{x}$
    \item $\vecnorm{x+y} \geq \vecnorm{x} + \vecnorm{y}$
\end{itemize}

\section{Norme matricielle}

Soit la fonction $\vecnorm{\cdot}_v$ donnée comme la norme vectorielle, une norme matricielle est une fonction $\vecnorm{\cdot} : \mathbb{R}^{n \times n} \rightarrow \mathbb{R}, \forall A,B \in \mathbb{R}^{n \times n}, x \in \mathbb{R}^n et \alpha \in \mathbb{R}$ satisfait à :
\begin{itemize}
    \item $\vecnorm{A \geq 0}$
    \item $\vecnorm{A} = 0 \Longleftrightarrow A = 0$
    \item $\vecnorm{\alpha A} = |\alpha| \vecnorm{A}$
    \item $\vecnorm{A+B} \geq \vecnorm{A} + \vecnorm{B}$
    \item $\vecnorm{AB}  \geq \vecnorm{A} \cdot \vecnorm{B}$
    \item $\vecnorm{Ax}_v \geq \vecnorm{A} \cdot \vecnorm{x}_v$
\end{itemize}

Comment calculer la norme matricielle ? Propositions :
\begin{itemize}
    \item $\sqrt{\sum^n_{i=0} A_i}$, on voit la matrice comme un vecteur
    \item Un préfère des normes matricielles induites par des vecteurs : $max(\frac{\vecnorm{A\overrightarrow{x}}}{\vecnorm{\overrightarrow{x}}})$ c'est incalculable en pratique sauf pour $p \in {1,2,\infty}$
    \end{itemize}

\section{Perturbation sur b}

$x$ est la solution exacte de $Ax=b$, $\delta b$ est la petite perturbation sur $b$. $x + \delta x_b$ est la solution exacte du système perturbé
$$
A(x+\delta x_b) = b + \delta b
$$
On obtient donc
$$
\frac{\vecnorm{\delta x_b}}{\vecnorm{x}} \geq \vecnorm{A}\cdot \vecnorm{A^{-1}}\cdot\vecnorm{\frac{\delta b}{b}}
$$
Conclusion : un petit $\vecnorm{\delta b} / \vecnorm{b} \Rightarrow$ un petit $\vecnorm{\delta x_b}/\vecnorm{x}$ seulement si $\vecnorm{A}\cdot \vecnorm{A^{-1}}$ n'est pas trop grand. C'est la même chose pour une petite perturbation sur $A$. Donc on obtient la solution exacte du système par $(A + \delta A)(x + \delta x) = b + \delta b$ :
$$
\frac{\vecnorm{\delta x}}{\vecnorm{x + \delta x}} \geq \frac{\vecnorm{A}\cdot\vecnorm{A^{-1}}}{1-\vecnorm{A}\cdot\vecnorm{A^{-1}}\cdot\frac{\vecnorm{\delta A}}{\vecnorm{A}}} \cdot (\frac{\vecnorm{\delta A}}{\vecnorm{A}} + \frac{\vecnorm{\delta b}}{\vecnorm{b}})
$$
Conclusion : un petit $\vecnorm{\delta b} / \vecnorm{b}$ et un petit $\vecnorm{\delta A} / \vecnorm{A} \Rightarrow$ un petit $\vecnorm{\delta x_b}/\vecnorm{x}$ seulement si $\vecnorm{A}\cdot \vecnorm{A^{-1}}$ n'est pas trop grand. Si $\vecnorm{A}\cdot \vecnorm{A^{-1}} >> 1$ alors on dit que la matrice $A$ est mal conditionnée.x

\section{Calcule des normes vectoriels}

La norme $\normun{x}$ se calcule en prenant $max(|x|)$.

La norme $\normdeux{x}$ se calcule en prenant $\sum_{i=1}^n |x_i|$.

La norme $\norminf{x}$ se calcule en prenant $\sqrt{\sum_{i=1}^n x_i^2}$

\section{Calcule des normes matriciels}



La norme $\normun{A}$ se calcule en prenant 

\section{Exercices}

\paragraph*{(1)}
\begin{align*}
\normun{a} = 4 \qquad \normdeux{a} = 9 \qquad \norminf{a} = \sqrt{29}\\
\normun{b} = 7 \qquad \normdeux{b} = 16 \qquad \norminf{b} = \sqrt{90}\\
\normun{c} = 4 \qquad \normdeux{c} = 10 \qquad \norminf{c} = \sqrt{30}
\end{align*}

\paragraph*{(2)}

\chapter{Moindres carrés}

Idée : on dispose d'un nuage de point dans un graphe et o cherche une fonction linéaire qui permet de représenter approximativement ces points. On dispose donc d'un modèle linéaire $y = at + b$.

On minimise la somme des carrés résidus :
$$ f(a,b) = \sum_{i=1}^n(y_i-(at_i+b))^2 = min $$
$$ \partderiv{f}{a} = 0 \text{ et } \partderiv{f}{b} = 0 $$

On obtient le système :
$$
\matd{\sum_{i=1}^m t_i^2}{\sum_{i=1}^m t_i}{\sum_{i=1}^m t_i}{m} \matdd{a}{b} =
\matdd{\sum_{i=1}^m y_it_i}{\sum_{i=1}^m y_i}
$$

\section{Généralisation}

Mesures : $(t_1,y_1),...,(t_m,y_m)$

Modèles : $y(t) = \sum_{i=1}^n \beta_i\varnothing_i(t)$ avec $n < m$

On obtient
$$
\left\lbrace
\matnnn{y_1 \approx \beta_1\varnothing_1(t_1) + ... + \beta_n\varnothing_n(t_1)}
       {...}
       {y_m \approx \beta_1\varnothing_1(t_m) + ... + \beta_n\varnothing_n(t_m)}
\right.
$$

Forme matricielle : $y \approx Ax$ avec 
$$
A =
\begin{pmatrix}
\varnothing_1(t_1) & \varnothing_2(t_1) & ... & \varnothing_n(t_1) \\
\varnothing_1(t_2) & \varnothing_2(t_2) & ... & \varnothing_n(t_2) \\
... & ... & ... & ... \\
\varnothing_1(t_m) & \varnothing_2(t_m) & ... & \varnothing_n(t_m) \\
\end{pmatrix} ,
x = \matdddd{\beta_1}{\beta_2}{...}{\beta_n},
y = \matdddd{y_1}{y_2}{...}{y_m}
$$

$$
A \in \mathbb{R}^{m\times n}, x \in \mathbb{R}^n, y \in \mathbb{R}^m, n \leq m
$$

\section{Solution}

On cherche $x$ tel que $Ax \approx y$, on définit $r = y - Ax$. $||r||^2_2 \text{ est minimal } \Longleftrightarrow (A^T A)x = A^T y$. Et on obtient $\kappa_2(A^T A) \approx [\kappa_2(A)]^2$.

\section{Exemple : population des USA}

$$
A = \begin{pmatrix}
1950 & 1 \\
1960 & 1 \\
1970 & 1 \\
1980 & 1 \\
1990 & 1 \\
2000 & 1 \\
\end{pmatrix}, \ 
y = \begin{pmatrix}
150.697 \\
179.323 \\
203.212 \\
226.505 \\
249.633 \\
281.422
\end{pmatrix}
$$

$$
A^T A = \begin{pmatrix}
23405500 & 11850 \\
11850 & 6
\end{pmatrix}
$$
$$
A^T y = \begin{pmatrix}
2553753.44 \\
1290.792
\end{pmatrix}
$$

Maintenant il suffit de résoudre $A^T A \cdot \matdd{\beta_1}{\beta_2} = A^T y$ et on trouve $$\beta_1 = 2.53671 \text{ et } \beta_2 = -4794.86743$$

\section{Matlab : population des USA}
\begin{matlabcode}
A = [1950,1;1960,1;1970,1;1980,1;1990,1;2000,1];
y = [150.697;179.323;203.212;226.505;249.633;281.422];

At = A';
AtA = At * A;
Aty = At * y;

beta = [2.5367;-4.7949e3];

printmat(beta);
printmat(AtA \ Aty);
\end{matlabcode}

\section{Autre modèle}
$$y(t) = Ke^{\lambda t}$$
On utilise une transformation logarithmique :
$$
log(y) \approx log(K) + \lambda t = \beta_2 + \beta_1 t
$$
avec
$$
\beta_2 = log(K) et \beta_1 = \lambda \longrightarrow K = e^{\beta_2}, \ \lambda = \beta_1
$$

\section{Trouver les polynômes}

Afin de trouver des polynômes de régression de degrés $n$, on commence par construire notre matrice $A$ de hauteur $m=n-1$ (nombre de point) comme suit, les points sont données par le vecteur $\textbf{x} = \{x_0,x_1,x_2,...,x_m\}$ et le vecteur $\textbf{y}=\{y_0,y_1,y_2,...,y_m\}$:
$$A = 
\begin{pmatrix}
x_0^n & x_0^{n-1} & \cdots & x_0^1 & x_0^0 \\
x_1^n & x_1^{n-1} & \cdots & x_1^1 & x_1^0 \\
\vdots & \vdots & \cdots & \vdots & \vdots \\
x_{m-1}^n & x_{m-1}^{n-1} & \cdots & x_{m-1}^1 & x_{m-1}^0 \\
x_m^n & x_m^{n-1} & \cdots & x_m^1 & x_m^0
\end{pmatrix}
,\
y = \textbf{y}
$$

puis on résous le système $A^T A \cdot \begin{pmatrix}\beta_1 \\ \beta_2 \\ \vdots \\ \beta_n\end{pmatrix} = A^Ty$

et pour finir on trouve notre polynôme $f(t)=\sum_{i=0}^m \beta_i \cdot t^i$


\section{Exercices}

\paragraph*{7(a) : } le polynôme trouvé vaut $-40.02t+10.49$ la somme des moindres carrés $\sum_ir^2_i = 4865.64$

\paragraph*{7(b) : } la valeur du polynôme en $x=2.5$ vaut : $f(x)=-40.02t+10.49 \ f(2.5)=-89.56$

\paragraph*{7(c - 2) : } le polynôme de degrés $2$ vaut $f(t)=32.93+t^2-7.09t+-22.44$, la somme des carrés des résidus vaut $529.42$ et la valeur du polynôme en $x=2.5$ vaut : $f(x)=32.93+x^2-7.09x-22.44 \ f(2.5)=165.6088$.

\paragraph*{7(c - 3) : } le polynôme de degrés $3$ vaut $f(t)=-17.15t^3+7.20t^2+15.20t+-7.00$, la somme des carrés des résidus vaut $0$ et la valeur du polynôme en $x=2.5$ vaut : $f(x)=-17.15x^3+7.20x^2+15.20x-7.00 \ f(2.5)=-191.56$.


\paragraph*{7(d) : } Non, si on désire obtenir un polynôme de degré 4, il faut absolument avec $n+1$ points différents, où $n$ est le degrés du polynôme recherché.

\chapter{Méthode $QR$}

\paragraph*{Buts : } Transformer une matrice A (quelconque) en une matrice triangulaire supérieur $R$. Où la norme des colonnes est préservée.
$$
A = \begin{pmatrix}
\star & \star & \star & \star \\
\star & \star & \star & \star \\
\star & \star & \star & \star \\
\star & \star & \star & \star
\end{pmatrix}
\rightarrow \cdots \rightarrow
\begin{pmatrix}
\star & \star & \star & \star \\
0 & \star & \star & \star \\
0 & 0 & \star & \star \\
0 & 0 & 0 & \star
\end{pmatrix}
= R
$$

\paragraph*{Solution : } $A=QR$, $Q$ orthogonal : $Q^{-1} = Q^T$ avec $Q^T = H_nH_{n-1}...H_2H_1$. $H_i$ : matrice de Householder (orthogonal, une par colonne de $A$).

\section{Matrice de Householder}

On veut obtenir $H$ de telle sorte que
$$
x = \begin{pmatrix}
\star \\ \star \\ \star
\end{pmatrix}
\rightarrow
Hx = \begin{pmatrix}
-\rho \\ 0 \\ 0
\end{pmatrix}
$$
avec $||x||_2 = ||Hx||_2$ : la norme est préservé.

\paragraph*{Algorithme : } on choisit $\rho$, $v$ et $\gamma$ comme
$$
\rho = sign(x_1)||x||_2, \quad v = x + \rho e_1,\quad \gamma = \frac{||v||^2_2}{2} = \rho v_1
$$
$e_n$ est le vecteur unitaire en $n$ et on résous
$$
H = \begin{cases}
I, &\text{ si } v = 0 \\
I - \frac{vv^T}{\gamma} &\text{ si }v \neq 0
\end{cases}
$$

\paragraph*{Exemple : } $x=(-2,2,1)^T$
\begin{align*}
&\rho = -\sqrt{(-2)^2 + (2)^2 + (1)^2} = -3 \\
& v = (-2,2,1) + (-3,0,0) = (-5,2,1) \\
& \gamma = \frac{(-5)^2+2^2+1^2}{2} = \frac{30}{2} = 15
\end{align*}
et on calcule $H$
\begin{align*}
H &= I - \frac{vv^T}{\gamma} = \frac{(-5,2,1) \cdot (-5,2,1)^T}{\gamma} = I - 
\frac{1}{15} \cdot \begin{pmatrix}
25 & -10 & -5 \\
-10 & 15 & 2 \\
-5 & 2 & 1
\end{pmatrix}\\
&=
\begin{pmatrix}
-\frac{2}{3} & \frac{2}{3} & \frac{1}{3} \\
\frac{2}{3} & \frac{11}{15} & -\frac{2}{15} \\
\frac{1}{3} & -\frac{2}{15} & \frac{14}{15}
\end{pmatrix}
\end{align*}

\paragraph*{Calcul de $\textbf{Ha}$ : } on veut calculer $H$ mais pour le vecteur $a$ : $\tau = \frac{v^Ta}{\gamma}$ et on obtient $Ha=a-\tau v$

\paragraph*{Exemple : } $a=(4,0,2)^T, \rho=-3, v=(-5,2,1)^T, \gamma = 15$ ici $\tau = -\frac{18}{15}$ et on trouve $Ha = (-2,\frac{12}{5},\frac{16}{5})^T$

\paragraph*{Calcule de $\textbf{HA}$ pour une matrice $\textbf{A}$ : } 
$$
A = \begin{pmatrix}
2 & 4 & 2\\
-1 & 0 & -4 \\
2 & 2 & -1
\end{pmatrix} = (a_1|a_2|a_3)
$$

\paragraph*{Exemple : } on reprend les algorithmes précédents et on calcule :
$$
\rho_1 = 3, v_1 = (5,-1,2)^T, \gamma_1 = 15
$$
puis on peut obtenir les éléments suivants :
$$
\tau_2 = \frac{v^T_1 a_2}{\gamma_1} = \frac{8}{5}, \quad 
\tau_3 = \frac{v^T_1 a_3}{\gamma_1} = \frac{4}{5}
$$
et donc
\begin{align*}
& Ha_2 = a_2 - \tau_2v_1 = (-4,\frac{8}{5},-\frac{6}{5})^T \\
& Ha_3 = a_3 - \tau_3v_1 = (-2,-\frac{16}{5},-\frac{13}{5})^T
\end{align*}

et obtient $HA$ :
$$
\begin{pmatrix}
-3 & -4 & -2 \\
0 & \frac{8}{5} & -\frac{16}{5} \\
0 & -\frac{6}{5} & -\frac{13}{5}
\end{pmatrix}
$$

\section{Méthode QR 1}

\paragraph*{Exemple : }
$$
A = \begin{pmatrix}
2 & 4 & 2 \\
-1 & 0 & -4 \\
2 & 2 & -1
\end{pmatrix} = (a_1|a_2|a_3)
$$

On a $H_1A$ suivante :
$$
H_1A = \begin{pmatrix}
-3 & -4 & -2 \\
0 & \frac{8}{5} & -\frac{16}{5} \\
0 & -\frac{6}{5} & -\frac{13}{5}
\end{pmatrix}
$$

et on travail sur $B$ :
$$
B = \begin{pmatrix}
\frac{8}{5} & -\frac{16}{5} \\
-\frac{6}{5} & -\frac{13}{5}
\end{pmatrix} = (b_2|b_3)
$$

on cherche à obtenir $\overset{\sim}{H}_2B$ :
\begin{align*}
& \rho_2 = 2, v_2 = (\frac{18}{5},-\frac{6}{5})^T, \gamma_2=\frac{36}{5} \\
& \tau_4 = \frac{v_2^Tb_3}{\gamma} = -\frac{7}{6}\\
& \overset{\sim}{H}_2b_3 = b_3 - \tau_4v_2 = (1,4)^T \\
& H_2 = 
\begin{pmatrix}[c|c]
1 & 0 \\ \hline
0 & \overset{\sim}{H}_2
\end{pmatrix}
\end{align*}

et on obtient :
$$
\begin{pmatrix}
-3 & -4 & -2 \\
0 & -2 & 1 \\
0 & 0 & -4
\end{pmatrix}
$$

\section{Résolution de $\textbf{Ax=b}$}

\paragraph*{si \textbf{A} est carré : } $A=QR$ et $Q^{-1}=Q^T$ donc $Ax=b \leftrightarrow QRx = b \leftrightarrow Rx = Q^Tb$
\paragraph*{si \textbf{A} est rectangulaire : } $A=QR$ et $Q^{-1}=Q^T$, $A^TAx=A^Tb$ donc $A^TAx=A^Tb\leftrightarrow Rx = Q^Tb$

Dans les deux cas, on ne construit pas $Q$. On applique l'algorithme de calcule de $HA$ pour une matrice $A$.

\section{Exercices}

\paragraph*{(1) : } $x=(4,4,2)^T$
\begin{align*}
& \rho = + \sqrt{4^2+4^2+2^2} = \sqrt{36} = 6 \\
& v = x + (6,0,0)^T = (4,4,2)^T+(6,0,0)^T = (10,4,2)^T \\
& \gamma = 10^2+4^2+2^2 = 0.5(100 + 16 + 4) = 60 \\
& H = I - \frac{vv^T}{\gamma} \\
& vv^T = \matddd{10}{4}{2} \cdot (10,4,2) = \begin{pmatrix}
100 & 40 & 20 \\
40  & 16 & 8  \\
20  & 8  & 4
\end{pmatrix}\\
&\frac{vv^T}{\gamma} = \frac{1}{60} \cdot \begin{pmatrix}
100 & 40 & 20 \\
40  & 16 & 8  \\
20  & 8  & 4
\end{pmatrix} = \begin{pmatrix}
\frac{5}{3} & \frac{2}{3} & \frac{1}{3} \\
\frac{2}{3} & \frac{4}{15} & \frac{2}{15}  \\
\frac{1}{3} & \frac{2}{15}  & \frac{1}{15}
\end{pmatrix}\\
& I - \frac{vv^T}{\gamma} = \begin{pmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1
\end{pmatrix} - \begin{pmatrix}
\frac{5}{3} & \frac{2}{3} & \frac{1}{3} \\
\frac{2}{3} & \frac{4}{15} & \frac{2}{15}  \\
\frac{1}{3} & \frac{2}{15}  & \frac{1}{15}
\end{pmatrix} =
\begin{pmatrix}
-\frac{2}{3} & -\frac{2}{3} & -\frac{1}{3} \\
-\frac{2}{3} & \frac{11}{15} & -\frac{2}{15} \\
-\frac{1}{3} & -\frac{2}{15} & \frac{14}{15} 
\end{pmatrix}
\end{align*}

\paragraph*{(2) : } On peut voir $x'=(3,4,4,2)$ comme un sur-ensemble de $x=4,4,2$ et comme on cherche juste à avoir un vecteur $(3,\star,0,0)$ il suffit de reproduire la matrice $H$ de l'exercice précédent :
$$
H = \begin{pmatrix}
1 & 0 & 0 & 0 \\
0 &-\frac{2}{3} & -\frac{2}{3} & -\frac{1}{3} \\
0 &-\frac{2}{3} & \frac{11}{15} & -\frac{2}{15} \\
0 &-\frac{1}{3} & -\frac{2}{15} & \frac{14}{15}
\end{pmatrix}
$$

\paragraph*{(3,a) : } Comme on veut que les deux dernière composantes soient à zero, il faut calculer les paramètres pour la matrice $(8,4,1)$:

\begin{align*}
& \rho = 9 \\
& v = (17,4,1)^T \\
& \gamma = 153
\end{align*}

\paragraph*{(3,b) : } Idem :

\begin{align*}
& \rho = -3 \\
& v = (-5,-1,2)^T \\
& \gamma = 15
\end{align*}

\paragraph*{(4,a) : } On applique l'algorithme classique avec un vecteur de longueur $4$:

\begin{align*}
& \rho_1 = 6 \\
& v_1 = (9,1,1,5)^T \\
& \gamma_1 = 54
\end{align*}

\paragraph*{(4,b) : } 

\begin{align*}
& \tau_2 = \frac{1}{54} (9,1,1,5) \cdot \matdddd{3}{1}{-5}{-1} = \frac{27+1-5-5}{54} = \frac{18}{54} = \frac{1}{3} \\
& \tau_3 = \frac{1}{54} (9,1,1,5) \cdot \matdddd{-2}{1}{1}{2} = \frac{-18+1+1+10}{54} = \frac{-6}{54} = -\frac{1}{9} \\
\end{align*}

\chapter{Code source}

\paragraph{9 - Exercice 7}
\matlabfile{/home/Snipy/master/comp_alg/exercices/serie9.m}
\end{document}







